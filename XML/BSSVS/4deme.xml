 <beast version='2.0'
        namespace='beast.evolution.alignment:beast.core:beast.core.parameter:beast.evolution.tree:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood:beast.evolution.migrationmodel:beast.math.distributions:master.beast'>

   <!-- CHOP_START -->
 
   <!-- TREE SIMULATION -->
 
   <alignment spec="beast.evolution.alignment.Alignment" id="input_alignment"
              dataType="nucleotide">
     <sequence spec="Sequence" taxon="t1" value="?" />
     <sequence spec="Sequence" taxon="t2" value="?" />
     <sequence spec="Sequence" taxon="t3" value="?" />
     <sequence spec="Sequence" taxon="t4" value="?" />
     <sequence spec="Sequence" taxon="t5" value="?" />
     <sequence spec="Sequence" taxon="t6" value="?" />
     <sequence spec="Sequence" taxon="t7" value="?" />
     <sequence spec="Sequence" taxon="t8" value="?" />
     <sequence spec="Sequence" taxon="t9" value="?" />
     <sequence spec="Sequence" taxon="t10" value="?" />
       <sequence spec="Sequence" taxon="t11" value="?" />
       <sequence spec="Sequence" taxon="t12" value="?" />
       <sequence spec="Sequence" taxon="t13" value="?" />
       <sequence spec="Sequence" taxon="t14" value="?" />
       <sequence spec="Sequence" taxon="t15" value="?" />
       <sequence spec="Sequence" taxon="t16" value="?" />
       <sequence spec="Sequence" taxon="t17" value="?" />
       <sequence spec="Sequence" taxon="t18" value="?" />
       <sequence spec="Sequence" taxon="t19" value="?" />
       <sequence spec="Sequence" taxon="t20" value="?" />
       <sequence spec="Sequence" taxon="t21" value="?" />
       <sequence spec="Sequence" taxon="t22" value="?" />
       <sequence spec="Sequence" taxon="t23" value="?" />
       <sequence spec="Sequence" taxon="t24" value="?" />
       <sequence spec="Sequence" taxon="t25" value="?" />
       <sequence spec="Sequence" taxon="t26" value="?" />
       <sequence spec="Sequence" taxon="t27" value="?" />
       <sequence spec="Sequence" taxon="t28" value="?" />
       <sequence spec="Sequence" taxon="t29" value="?" />
       <sequence spec="Sequence" taxon="t30" value="?" />
       <sequence spec="Sequence" taxon="t31" value="?" />
       <sequence spec="Sequence" taxon="t32" value="?" />
       <sequence spec="Sequence" taxon="t33" value="?" />
       <sequence spec="Sequence" taxon="t34" value="?" />
       <sequence spec="Sequence" taxon="t35" value="?" />
       <sequence spec="Sequence" taxon="t36" value="?" />
       <sequence spec="Sequence" taxon="t37" value="?" />
       <sequence spec="Sequence" taxon="t38" value="?" />
       <sequence spec="Sequence" taxon="t39" value="?" />
       <sequence spec="Sequence" taxon="t40" value="?" />
       <sequence spec="Sequence" taxon="t41" value="?" />
       <sequence spec="Sequence" taxon="t42" value="?" />
       <sequence spec="Sequence" taxon="t43" value="?" />
       <sequence spec="Sequence" taxon="t44" value="?" />
       <sequence spec="Sequence" taxon="t45" value="?" />
       <sequence spec="Sequence" taxon="t46" value="?" />
       <sequence spec="Sequence" taxon="t47" value="?" />
       <sequence spec="Sequence" taxon="t48" value="?" />
       <sequence spec="Sequence" taxon="t49" value="?" />
       <sequence spec="Sequence" taxon="t50" value="?" />
       <sequence spec="Sequence" taxon="t51" value="?" />
       <sequence spec="Sequence" taxon="t52" value="?" />
       <sequence spec="Sequence" taxon="t53" value="?" />
       <sequence spec="Sequence" taxon="t54" value="?" />
       <sequence spec="Sequence" taxon="t55" value="?" />
       <sequence spec="Sequence" taxon="t56" value="?" />
       <sequence spec="Sequence" taxon="t57" value="?" />
       <sequence spec="Sequence" taxon="t58" value="?" />
       <sequence spec="Sequence" taxon="t59" value="?" />
       <sequence spec="Sequence" taxon="t60" value="?" />
       <sequence spec="Sequence" taxon="t61" value="?" />
       <sequence spec="Sequence" taxon="t62" value="?" />
       <sequence spec="Sequence" taxon="t63" value="?" />
       <sequence spec="Sequence" taxon="t64" value="?" />
       <sequence spec="Sequence" taxon="t65" value="?" />
       <sequence spec="Sequence" taxon="t66" value="?" />
       <sequence spec="Sequence" taxon="t67" value="?" />
       <sequence spec="Sequence" taxon="t68" value="?" />
       <sequence spec="Sequence" taxon="t69" value="?" />
       <sequence spec="Sequence" taxon="t70" value="?" />
       <sequence spec="Sequence" taxon="t71" value="?" />
       <sequence spec="Sequence" taxon="t72" value="?" />
       <sequence spec="Sequence" taxon="t73" value="?" />
       <sequence spec="Sequence" taxon="t74" value="?" />
       <sequence spec="Sequence" taxon="t75" value="?" />
       <sequence spec="Sequence" taxon="t76" value="?" />
       <sequence spec="Sequence" taxon="t77" value="?" />
       <sequence spec="Sequence" taxon="t78" value="?" />
       <sequence spec="Sequence" taxon="t79" value="?" />
       <sequence spec="Sequence" taxon="t80" value="?" />
       <sequence spec="Sequence" taxon="t81" value="?" />
       <sequence spec="Sequence" taxon="t82" value="?" />
       <sequence spec="Sequence" taxon="t83" value="?" />
       <sequence spec="Sequence" taxon="t84" value="?" />
       <sequence spec="Sequence" taxon="t85" value="?" />
       <sequence spec="Sequence" taxon="t86" value="?" />
       <sequence spec="Sequence" taxon="t87" value="?" />
       <sequence spec="Sequence" taxon="t88" value="?" />
       <sequence spec="Sequence" taxon="t89" value="?" />
       <sequence spec="Sequence" taxon="t90" value="?" />
       <sequence spec="Sequence" taxon="t91" value="?" />
       <sequence spec="Sequence" taxon="t92" value="?" />
       <sequence spec="Sequence" taxon="t93" value="?" />
       <sequence spec="Sequence" taxon="t94" value="?" />
       <sequence spec="Sequence" taxon="t95" value="?" />
       <sequence spec="Sequence" taxon="t96" value="?" />
       <sequence spec="Sequence" taxon="t97" value="?" />
       <sequence spec="Sequence" taxon="t98" value="?" />
       <sequence spec="Sequence" taxon="t99" value="?" />
       <sequence spec="Sequence" taxon="t100" value="?" />
       <sequence spec="Sequence" taxon="t101" value="?" />
       <sequence spec="Sequence" taxon="t102" value="?" />
       <sequence spec="Sequence" taxon="t103" value="?" />
       <sequence spec="Sequence" taxon="t104" value="?" />
       <sequence spec="Sequence" taxon="t105" value="?" />
       <sequence spec="Sequence" taxon="t106" value="?" />
       <sequence spec="Sequence" taxon="t107" value="?" />
       <sequence spec="Sequence" taxon="t108" value="?" />
       <sequence spec="Sequence" taxon="t109" value="?" />
       <sequence spec="Sequence" taxon="t110" value="?" />
       <sequence spec="Sequence" taxon="t111" value="?" />
       <sequence spec="Sequence" taxon="t112" value="?" />
       <sequence spec="Sequence" taxon="t113" value="?" />
       <sequence spec="Sequence" taxon="t114" value="?" />
       <sequence spec="Sequence" taxon="t115" value="?" />
       <sequence spec="Sequence" taxon="t116" value="?" />
       <sequence spec="Sequence" taxon="t117" value="?" />
       <sequence spec="Sequence" taxon="t118" value="?" />
       <sequence spec="Sequence" taxon="t119" value="?" />
       <sequence spec="Sequence" taxon="t120" value="?" />
       <sequence spec="Sequence" taxon="t121" value="?" />
       <sequence spec="Sequence" taxon="t122" value="?" />
       <sequence spec="Sequence" taxon="t123" value="?" />
       <sequence spec="Sequence" taxon="t124" value="?" />
       <sequence spec="Sequence" taxon="t125" value="?" />
       <sequence spec="Sequence" taxon="t126" value="?" />
       <sequence spec="Sequence" taxon="t127" value="?" />
       <sequence spec="Sequence" taxon="t128" value="?" />
 
   </alignment>
 
   <tree spec="BeastTreeFromMaster" id="true_tree">
       
     <model spec='InheritanceModel'>
       <populationType spec='PopulationType' typeName='X' dim="4" id='X'/>
         
       <reactionGroup spec='InheritanceReactionGroup' reactionGroupName='Coalescence'>
         <reaction spec='InheritanceReaction' rate="1"> <!-- N[0] = 0.5 -->
           2X[0]:1 -> X[0]:1
         </reaction>
         <reaction spec='InheritanceReaction' rate="0.25"> <!-- N[1] = 2 -->
           2X[1]:1 -> X[1]:1
         </reaction>
         <reaction spec='InheritanceReaction' rate="0.5"> <!-- N[2] = 1 -->
           2X[2]:1 -> X[2]:1
         </reaction>
         <reaction spec='InheritanceReaction' rate="0.5"> <!-- N[2] = 1 -->
           2X[3]:1 -> X[3]:1
         </reaction>
       </reactionGroup>
         
       <reactionGroup spec='InheritanceReactionGroup' reactionGroupName='Migration'>

         <reaction spec='InheritanceReaction' rate="0.4">
           X[0] -> X[3]
         </reaction>
         <reaction spec='InheritanceReaction' rate="0.4">
           X[0] -> X[1]
         </reaction>
         <reaction spec='InheritanceReaction' rate="0.4">
           X[2] -> X[1]
         </reaction>

         <reaction spec='InheritanceReaction' rate="0.2">
           X[3] -> X[0]
         </reaction>
         <reaction spec='InheritanceReaction' rate="0.2">
           X[1] -> X[0]
         </reaction>
         <reaction spec='InheritanceReaction' rate="0.2">
           X[1] -> X[2]
         </reaction>

         <reaction spec='InheritanceReaction' rate="0.3">
           X[3] -> X[2]
         </reaction>
         <reaction spec='InheritanceReaction' rate="0.3">
           X[2] -> X[3]
         </reaction>

       </reactionGroup>
         
     </model>
 
     <alignment idref='input_alignment'/>
 
       <initialState spec='InitState'>

<lineageSeed spec='Individual' label="t1" time="0">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t2" time="0">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t3" time="0">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t4" time="0">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t5" time="0">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t6" time="0">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t7" time="0">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t8" time="0">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t9" time="0">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t10" time="0">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t11" time="0">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t12" time="0">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t13" time="0">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t14" time="0">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t15" time="0">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t16" time="0">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t17" time="0">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t18" time="0">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t19" time="0">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t20" time="0">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t21" time="0">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t22" time="0">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t23" time="0">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t24" time="0">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t25" time="0">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t26" time="0">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t27" time="0">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t28" time="0">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t29" time="0">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t30" time="0">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t31" time="0">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t32" time="0">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t33" time="1">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t34" time="1">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t35" time="1">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t36" time="1">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t37" time="1">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t38" time="1">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t39" time="1">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t40" time="1">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t41" time="1">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t42" time="1">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t43" time="1">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t44" time="1">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t45" time="1">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t46" time="1">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t47" time="1">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t48" time="1">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t49" time="1">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t50" time="1">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t51" time="1">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t52" time="1">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t53" time="1">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t54" time="1">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t55" time="1">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t56" time="1">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t57" time="1">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t58" time="1">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t59" time="1">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t60" time="1">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t61" time="1">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t62" time="1">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t63" time="1">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t64" time="1">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t65" time="2">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t66" time="2">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t67" time="2">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t68" time="2">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t69" time="2">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t70" time="2">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t71" time="2">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t72" time="2">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t73" time="2">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t74" time="2">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t75" time="2">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t76" time="2">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t77" time="2">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t78" time="2">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t79" time="2">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t80" time="2">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t81" time="2">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t82" time="2">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t83" time="2">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t84" time="2">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t85" time="2">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t86" time="2">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t87" time="2">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t88" time="2">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t89" time="2">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t90" time="2">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t91" time="2">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t92" time="2">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t93" time="2">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t94" time="2">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t95" time="2">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t96" time="2">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t97" time="3">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t98" time="3">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t99" time="3">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t100" time="3">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t101" time="3">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t102" time="3">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t103" time="3">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t104" time="3">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t105" time="3">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t106" time="3">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t107" time="3">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t108" time="3">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t109" time="3">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t110" time="3">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t111" time="3">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t112" time="3">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t113" time="3">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t114" time="3">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t115" time="3">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t116" time="3">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t117" time="3">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t118" time="3">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t119" time="3">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t120" time="3">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t121" time="3">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t122" time="3">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t123" time="3">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t124" time="3">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t125" time="3">
<population spec='Population' type="@X" location="1"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t126" time="3">
<population spec='Population' type="@X" location="2"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t127" time="3">
<population spec='Population' type="@X" location="3"/>
</lineageSeed>
<lineageSeed spec='Individual' label="t128" time="3">
<population spec='Population' type="@X" location="0"/>
</lineageSeed>

       </initialState>
 
     <lineageEndCondition spec='LineageEndCondition' nLineages="1"/>
 
     <output spec='NexusOutput' fileName='true_tree.nexus' reverseTime='true'/>
   </tree>
 
 
   <!-- SEQUENCE SIMULATION -->
 
   <siteModel spec="SiteModel" id="trueSiteModel" mutationRate="0.005">
     <!--<substModel spec="JukesCantor"/>-->
     <substModel spec="HKY" kappa="3.0">
       <frequencies spec='Frequencies' frequencies="0.25 0.25 0.25 0.25"/>
     </substModel>
   </siteModel>
 
   <data spec='beast.app.seqgen.SimulatedAlignment' id='simulated_alignment'
 	data="@input_alignment"
 	tree="@true_tree"
 	sequencelength="2000"
 	siteModel="@trueSiteModel"
 	outputFileName="simulated_alignment.xml">
   </data>


   <!-- CHOP_END -->
 
   <!-- INFERENCE  -->
 
   <typeTraitSet spec='TraitSet' id='typeTraitSet'
 	  traitname="discrete"
 	  value="t1=1,
t2=2,
t3=3,
t4=0,
t5=1,
t6=2,
t7=3,
t8=0,
t9=1,
t10=2,
t11=3,
t12=0,
t13=1,
t14=2,
t15=3,
t16=0,
t17=1,
t18=2,
t19=3,
t20=0,
t21=1,
t22=2,
t23=3,
t24=0,
t25=1,
t26=2,
t27=3,
t28=0,
t29=1,
t30=2,
t31=3,
t32=0,
t33=1,
t34=2,
t35=3,
t36=0,
t37=1,
t38=2,
t39=3,
t40=0,
t41=1,
t42=2,
t43=3,
t44=0,
t45=1,
t46=2,
t47=3,
t48=0,
t49=1,
t50=2,
t51=3,
t52=0,
t53=1,
t54=2,
t55=3,
t56=0,
t57=1,
t58=2,
t59=3,
t60=0,
t61=1,
t62=2,
t63=3,
t64=0,
t65=1,
t66=2,
t67=3,
t68=0,
t69=1,
t70=2,
t71=3,
t72=0,
t73=1,
t74=2,
t75=3,
t76=0,
t77=1,
t78=2,
t79=3,
t80=0,
t81=1,
t82=2,
t83=3,
t84=0,
t85=1,
t86=2,
t87=3,
t88=0,
t89=1,
t90=2,
t91=3,
t92=0,
t93=1,
t94=2,
t95=3,
t96=0,
t97=1,
t98=2,
t99=3,
t100=0,
t101=1,
t102=2,
t103=3,
t104=0,
t105=1,
t106=2,
t107=3,
t108=0,
t109=1,
t110=2,
t111=3,
t112=0,
t113=1,
t114=2,
t115=3,
t116=0,
t117=1,
t118=2,
t119=3,
t120=0,
t121=1,
t122=2,
t123=3,
t124=0,
t125=1,
t126=2,
t127=3,
t128=0">
     <taxa spec='TaxonSet' alignment='@simulated_alignment'/>
   </typeTraitSet>

   <traitSet spec='TraitSet' id='timeTraitSet'
 	    traitname="time"
 	    value="t1=0,
t2=0,
t3=0,
t4=0,
t5=0,
t6=0,
t7=0,
t8=0,
t9=0,
t10=0,
t11=0,
t12=0,
t13=0,
t14=0,
t15=0,
t16=0,
t17=0,
t18=0,
t19=0,
t20=0,
t21=0,
t22=0,
t23=0,
t24=0,
t25=0,
t26=0,
t27=0,
t28=0,
t29=0,
t30=0,
t31=0,
t32=0,
t33=1,
t34=1,
t35=1,
t36=1,
t37=1,
t38=1,
t39=1,
t40=1,
t41=1,
t42=1,
t43=1,
t44=1,
t45=1,
t46=1,
t47=1,
t48=1,
t49=1,
t50=1,
t51=1,
t52=1,
t53=1,
t54=1,
t55=1,
t56=1,
t57=1,
t58=1,
t59=1,
t60=1,
t61=1,
t62=1,
t63=1,
t64=1,
t65=2,
t66=2,
t67=2,
t68=2,
t69=2,
t70=2,
t71=2,
t72=2,
t73=2,
t74=2,
t75=2,
t76=2,
t77=2,
t78=2,
t79=2,
t80=2,
t81=2,
t82=2,
t83=2,
t84=2,
t85=2,
t86=2,
t87=2,
t88=2,
t89=2,
t90=2,
t91=2,
t92=2,
t93=2,
t94=2,
t95=2,
t96=2,
t97=3,
t98=3,
t99=3,
t100=3,
t101=3,
t102=3,
t103=3,
t104=3,
t105=3,
t106=3,
t107=3,
t108=3,
t109=3,
t110=3,
t111=3,
t112=3,
t113=3,
t114=3,
t115=3,
t116=3,
t117=3,
t118=3,
t119=3,
t120=3,
t121=3,
t122=3,
t123=3,
t124=3,
t125=3,
t126=3,
t127=3,
t128=3">
     <taxa spec='TaxonSet' alignment='@simulated_alignment'/>
   </traitSet>

   <!-- Substitution model -->
   <siteModel spec="SiteModel" id="siteModel">
     <mutationRate spec='RealParameter' id="mutationRate" value="1.0"/>
     <!--<substModel spec="JukesCantor"/>-->
     <substModel spec="HKY">
       <kappa spec='RealParameter' id="hky.kappa" value="1.0"/>
       <frequencies estimate="false" spec='Frequencies'>
	 <frequencies spec='RealParameter' id="hky.freq" value="0.25 0.25 0.25 0.25"/>
       </frequencies>
     </substModel>
   </siteModel>
 
   <!-- Migration model -->
   <migrationModel spec='MigrationModel' id='migModel'>
     <rateMatrix spec='RealParameter' value="1.0" dimension="12" id="rateMatrix"/>
     <rateMatrixFlags spec='BooleanParameter' value="true" dimension="12" id="rateMatrixFlags"/>
     <popSizes spec='RealParameter' value="1.0" dimension="4" id="popSizes"/>
   </migrationModel>
 
   <!-- Parameter priors -->
   <input spec='CompoundDistribution' id='parameterPriors'>
     <distribution spec='beast.math.distributions.Prior' x="@mutationRate">
       <distr spec='LogNormalDistributionModel' M="0.0" S="4.0"/>
     </distribution>

     <distribution spec='beast.math.distributions.Prior' x="@hky.kappa">
       <distr spec='LogNormalDistributionModel' M="0.0" S="4.0"/>
     </distribution>

     <distribution spec='beast.math.distributions.Prior' x="@rateMatrix">
       <distr spec='Exponential' mean="0.1"/>
     </distribution>
     <distribution spec='beast.math.distributions.Prior' x="@popSizes">
       <distr spec="LogNormalDistributionModel"  M="0.0" S="4.0"/>
     </distribution>
     
     <distribution spec='beast.math.distributions.Prior'>
         <x spec='Sum' arg="@rateMatrixFlags"/>
         <distr spec='Poisson' lambda="5"/>
     </distribution>
   </input>
 
   <!-- Probability of sequence data given tree -->
   <input spec='TreeLikelihood' id="treeLikelihood">
     <data idref="simulated_alignment"/>
     <tree idref="tree"/>
     <siteModel idref='siteModel'/>
   </input>
   
   <!-- Probability of tree given migration rates and population sizes -->
   <input spec='StructuredCoalescentLikelihood' id='treePrior'>
     <multiTypeTree idref="tree"/>
     <migrationModel idref="migModel"/>
   </input>


   <run spec="MCMC" id="mcmc" chainLength="100000000">
     
     <init spec='StructuredCoalescentMultiTypeTree' id='tree' nTypes="4">
         <migrationModel spec='MigrationModel'>
             <rateMatrix spec='RealParameter' dimension="12" value="1.0"/>
             <popSizes spec='RealParameter' dimension="4" value="1.0"/>
         </migrationModel>
         <typeTraitSet idref='typeTraitSet'/>
         <timeTraitSet idref='timeTraitSet'/>
     </init>
 
     <state>
       <stateNode idref="tree"/>
       <stateNode idref="rateMatrix"/>
       <stateNode idref="rateMatrixFlags"/>
       <stateNode idref="popSizes"/>
       <stateNode idref="mutationRate"/>
       <stateNode idref="hky.kappa"/>
       <stateNode idref="hky.freq"/>
     </state>
     
     <distribution spec='CompoundDistribution' id='posterior'>
       <distribution idref="treeLikelihood"/>
       <distribution idref='treePrior'/>
       <distribution idref="parameterPriors"/>
     </distribution>

 
     <!-- parameter scaling operators -->

     <operator spec='ScaleOperator' id='RateScaler'
 	      parameter="@rateMatrix"
 	      scaleFactor="0.8" weight="1">
     </operator>

     <operator spec="ScaleOperator" id="PopSizeScaler"
 	      parameter="@popSizes"
	      scaleFactor="0.8" weight="1"/>

     <operator spec="ScaleOperator" id="muRateScaler"
	       parameter="@mutationRate"
	       scaleFactor="0.8" weight="1"/>


     <operator spec='ScaleOperator' id='kappaScaler'
	       parameter="@hky.kappa"
	       scaleFactor="0.8" weight="0.1">
     </operator>

     <operator spec="DeltaExchangeOperator" id="freqExchanger"
	       parameter="@hky.freq"
	       delta="0.01" weight="0.1"/>


     <operator spec="UpDownOperator" id="upDown"
               scaleFactor="0.8" weight="1">
       <up idref="popSizes"/>
       <down idref="mutationRate"/>
       <down idref="rateMatrix"/>
     </operator>

     <!-- BSVS -->
     <operator spec='BitFlipOperator' id='bitFlipOperator'
               parameter='@rateMatrixFlags' weight="1"/>


     <!-- Multi-type tree operators -->
     <operator spec='TypedSubtreeExchange' id='STX'
 	      weight="10" multiTypeTree="@tree"
 	      migrationModel="@migModel"/>
     
     <operator spec="TypedWilsonBalding" id="TWB"
 	      weight="10" multiTypeTree="@tree"
 	      migrationModel="@migModel" alpha="0.2"/>
     
     <operator spec="NodeRetype" id="NR"
 	      weight="10" multiTypeTree="@tree"
 	      migrationModel="@migModel"/>

     <operator spec="NodeShiftRetype" id="NSR1"
               weight="10" multiTypeTree="@tree"
               rootScaleFactor="0.8"
	       migrationModel="@migModel" rootOnly="true"/>

     <operator spec="NodeShiftRetype" id="NSR2"
               weight="10" multiTypeTree="@tree"
               migrationModel="@migModel" noRoot="true"/>
     
     <operator spec="CompoundOperator" id="JointFlipRetype" weight="10">
         <operator idref="bitFlipOperator"/>
         <operator idref="NR"/>
     </operator>

     <operator spec="MultiTypeUniform" id="MTU"
	       weight="10" multiTypeTree="@tree"
	       includeRoot="true"
	       rootScaleFactor="0.9"/>
          
     <operator spec="MultiTypeTreeScale" id="MTTS1"
 	      weight="10" multiTypeTree="@tree"
 	      scaleFactor="0.98" useOldTreeScaler="true">
       <parameter idref="popSizes"/>

       <parameterInverse idref="mutationRate"/>
       <parameterInverse idref="rateMatrix"/>
     </operator>

     <operator spec="MultiTypeTreeScale" id="MTTS2"
 	      weight="10" multiTypeTree="@tree"
 	      scaleFactor="0.98" useOldTreeScaler="true">
     </operator>

     <!-- Loggers -->
     
     <logger logEvery="1000" fileName="4deme.log">
       <model idref='posterior'/>
       <log idref="posterior"/>
       <log idref="treeLikelihood"/>
       <log idref="treePrior"/>
       <log idref="migModel"/>
       <log idref="mutationRate"/>
       <log idref="hky.kappa"/>
       <log idref="hky.freq"/>
       <log spec='TreeHeightLogger' tree='@tree'/>
       <log spec='TreeLengthLogger' tree='@tree'/>
       <log spec='TypeChangeCountLogger' logEachDirection="true"
            multiTypeTree="@tree"/>
       <log spec='TypeChangeCountLogger' logEachDirection="false"
            multiTypeTree="@tree"/>
       <log spec='TreeRootTypeLogger' multiTypeTree="@tree"/>
     </logger>

     <logger logEvery="10000" fileName="4deme.trees" mode="tree">
       <log idref="tree"/>
     </logger>

     <logger logEvery="10000">
       <model idref='posterior'/>
       <log idref="posterior"/>
       <log idref="treeLikelihood"/>
       <log idref="treePrior"/>
       <log spec='TreeHeightLogger' tree='@tree'/>
       <log idref="mutationRate"/>
       <ESS spec='ESS' name='log' arg="@treePrior"/>
     </logger>
   </run>
   
 </beast>
