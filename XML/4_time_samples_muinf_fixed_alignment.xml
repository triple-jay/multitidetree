 <beast version='2.0'
        namespace='beast.evolution.alignment:beast.core:beast.core.parameter:beast.evolution.tree:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood:beast.evolution.migrationmodel:beast.math.distributions:master.beast'>

   <!-- Fails on third sample with seed 1364337609919 -->
 
   <!-- SEQUENCE ALIGNMENT -->
   <input id='simulated_alignment' spec='Alignment'>
       <sequence taxon='t1' value='CTGTATCGAAACATGAGTGGTAAAAAAGCGCTTTACAGTCCATTAACGATGGCCATGGATGGGTGTCTGATGTGTATTACCTGCTCTGGGACTTGTTTCGTCGAACTGCATGCTTCTACTAAGAGCTCCGGGTGAAGGGCGGTGGCCAAGGCGCTGCTCGCACGGCCCACTCGCCTAGACTAAGACGATAGGCACTATCTTACAGCCCTGACGCTCGCGCCCATTTGGGCCGGTCGCACACCTGAAGGTAGGGTCAATATTGCCGCGCCCTACTCCTATATCGGGTGTAACTGTAGAACTTGATAGAAAGAGCCTTTCTTCTACGTAAGCAATTCGTTACAGATTATAGTCCCAGCAGACCGTAATGTGTCACTCCAGGTTCCTGTCGTAACTTACTCAGTCGGTAAAGTGATACGATGACCTCCGTTAGGATTCAGTCTAAGCAACGTACACAGGGGGGAATTAATCCTGCATTAACCGCTCGGCCCAGTAGAAGTCTCAGTGGAACGGGACCCAGCCCCATCGAGTCAAGCTCTCTTGCTGCCACGGTTAAGTCAGGCTAATCGCGTGCGAATGTCCCGGCTACTTAGCCGGAACTCCCATGCATCAACTCGTCCTCAGGGCCTGGTCACTCTCTGGATAAACTCCAAAGTTTTCTAACACACGTGGAAATCTGACACCGACATCTGTCTGATATGCAATCATACTAGAGCTAGCGCATGACCCTTTGAATCCATTAAGAGGAGGGTTCAGTAGTGTGCCAAAACGAATCAGAGGGTCGGACCGAGTTTAGTGTGAGTATAATCTAAAGTTACGCTGTGGCTTGGTATGATGATGATTTACCAACACTCCGCAAAACGCTCCAATGCTCGTGTGCTATACTCGACCCCTAGGGCTTGAAGAGGTCACGGAGAGGGACGTGGTCGTTAGGTTTGGCCTCCAATTTTTGTGTTAAAAACTTTGTCCATCGGGTTACCTAGCTACCTGCGCACTCGTACAACGGAATATCTATTTGGCGGATCATAATAGACTAGGTGTCCCGTCCCTAACAACTATGGCGAACTAGACCTCCGATGAGGGGGCCGTAGAGATCATCGCGACAGAATCTCCTAGGTTGCCCCTCTACATCGATAAAACAACACTACTTACCGCTTTCCCCGAAGATTCGCTTAGCTTATAGACCTCGCGGGCACCGGGAGTGGCCATCACTTAACACCGCTACAGGACCTCTTAGGAGAGTGTGGGTCAGATTCCGATTACTCAGTTCCAACTTGGTCAGATAATGACAGGTAAGTCAGGACTGATCGGATTCCGTGAACGGACGTGGTTTGCACGCCGGGAGAGTCGGATCCACCCAGTCTCCGAACCGATCATTTCCTCCTTGTAATCTCGTAGGGACGACACCCACGAATAAATGAAGGGTTTAATAGTCTTAGTGACTGCGTACGCAAGTACTGAACGATAAATCTTTATCGGATTTACCTAACAGTGACTATGGGTTCGAACTTAAAGCGTATTAAAGTCTTCAGTCTACACGTCCACCGCTTGATGACAAGGTCGATAGGTCGTTCTCGGGGCTTTAGTAGCACGCCGTTGTAGTCAGATCTGCCAGTTTCGATGCCTCACGCTAAGCCCCTCAACGGTCGGGACCGAGTGGGTTGTTGAAGTTCAAACCCGATAGGTCCACAGCCTTCAAAACTGAAGTTGTGAGTAACATGGGGTGGTTCGCATGACGGTAAGTCAGCACAGCAATGGAGGTCATCCCGAAACGACGGAAGCTCCCGGCCTTTACCGTGCAAATCTTTCGGGGTAGCGGGGTTAACAGTAGAGCCGCAGGGGAGCTTAGTCCAGAAATCCAAATCGGGGAGGCATTGGAACGCCGACGCTGTCCCTGCTACCGTGCCGATTCCGGCGCCCTGGCGGCTTATGGATGGGACGCCGCACTAAGATGTGTACAGTAGGGTTTGTCCTTAAAATTGCGTGTCCCGACTACAGGCCTA'/>

       <sequence taxon='t2' value='CTGTATCGAAACATGAGTGGTAAAAAAGCGCTTTACAGTCCATTAACGATGGCCATGGATGGGTGTCTGATGTGTATTACCTGCTCTGGGACTTGTTTCGTCGAACTGCATGCTTCTACTAAGAGCTCCGGGTGAAGGGCGGTGGCCAAGGCGCTGCTCGCACGGCCCACTCGCCTAGACTAAGACGATAGGCACTATCTTACAGCCCTGACGCTCGCGCCCATTTGGGCCGGTCGCACACCTGAAGGTAGGGTCAATATTGCCGCGCCCTACTCCTATATCGGGTGTAACTGTAGAACTTGATAGAAAGAGCCTTTCTTCTACGTAAGCAATTCGTTACAGATTATAGTCCCAGCAGACCGTAATGTGTCACTCCAGGTTCCTGTCGTAACTTACTCAGTCGGTAAAGTGATACGATGACCTCCGTTAGGATTCAGTCTAAGCAACGTACACAGGGGGGAATTAATCCTGCATTAACCGCTCGGCCCAGTAGAAGTCTCAGTGGAACGGGACCCAGCCCCATCGAGTCAAGCTCTCTTGCTGCCACGGTTAAGTCAGGCTAATCGCGTGCGAATGTCCCGGCTACTTAGCCGGAACTCCCATGCATCAACTCGTCCTCAGGGCCTGGTCACTCTCTGGATAAACTCCAAAGTTTTCTAACACACGTGGAAATCTGACACCGACATCTGTCTGATATGCAATCATACTAGAGCTAGCGCATGACCCTTTGAATCCATTAAGAGGAGGGTTCAGTAGTGTGCCAAAACGAATCAGAGGGTCGGACCGAGTTTAGTGTGAGTATAATCTAAAGTTACGCTGTGGCTTGGTATGATGATGATTTACCAACACTCCGCAAAACGCTCCAATGCTCGTGTGCTATACTCGACCCCTAGGGCTTGAAGAGGTCACGGAGAGGGACGTGGTCGTTAGGTTTGGCCTCCAATTTTTGTGTTAAAAACTTTGTCCATCGGGTTACCTAGCTACCTGCGCACTCGTACAACGGAATATCTATTTGGCGGATCATAATAGACTAGGTGTCCCGTCCCTAACAACTATGGCGAACTAGACCTCCGATGAGGGGGCCGTAGAGATCATCGCGACAGAATCTCCTAGGTTGCCCCTCTACAGCGATAAAACAACACTACTTACCGCTTTCCCCGAAGATTCGCTTAGCTTATAGACCTCGCGGGCACCGGGAGTGGCCATCACTTAACACCGCTACAGGACCTCTTAGGAGAGTGTGGGTCAGATTCCGATTACTCAGTTCCAACTTGGTCAGATAATGACAGGTAAGTCAGGACTGATCGGATTCCGTGAACGGACGTGGTTTGCACGCCGGGAGAGTCGGATCCACCCAGTCTCCGAACCGATCATTTCCTCCTTGTAATCTCGTAGGGACGACACCCACGAATAAATGAAGGGTTTAATAGTCTTAGTGACTGCGTACGCAAGTACTGAACGATAAATCTTTATCGGATTTACCTAACAGTGACTATGGGTTCGAACTTAAAGCGTATTAAAGTCTTCAGTCTACACGTCCACCGCTTGATGACAAGGTCGATAGGTCGTTCTCGGGGCTTTAGTAGCACGCCGTTGTAGTCAGATCTGCCAGTTTCGATCCCTCACGCTAAGCCCCTCAACGGTCGGGACCGAGTGGGTTGTTGAAGTTCAAACCCGATAGGTCCACAGCCTTCAAAACTGAAGTTGTGAGTAACATGGGGTGGTTCGCATGACGGTAAGTCAGCACAGCAATGGAGGTCATCCCGAAACGACGGAAGCTCCCGGCCTTTACCGTGCAAATCTTTCGGGGTAGCGGGGTTAACAGTAGAGCCGCAGGGGAGCTTAGTCCAGAAATCCAAATCGGGGAGGCATTGGAACGCCGACGCTGTCCCTGCTACCGTGCCGATTCCGGCGCCCTGGCGGCTTATGGATGGGACGCCGCACTAAGATGTGTACAGTAGGGTTTGTCCTTAAAATTGCGTGTCCCGACTACAGGCCTA'/>

       <sequence taxon='t3' value='CTGTATCGAAACATGAGTGGTAAAAAAGCGCTTTACAGTCCATTAACGATGGCCATGGATGGGTGTCTGATGTGTATTACCTGCTCTGGGACTTGTTTCGTCGAACTGCATGCTTCTACTAAGAGCTCCGGGTGAAGGGCGGTGGCCAAGGCGCTGCTCGCACGGCCCACTCGCCTAGACTAAGACGATAGGCACTATCTTACAGCCCTGACGCTCGCGCCCATTTGGGCGGGTCGCACACCTGAAGGTAGGGTCAATATTGCCGCGCCCTACTCCTATATCGGGTGTAACTGTAGAACTTGATAGAAAGAGCCTTTCTTCTACGTAAGCAATTCGTTACAGATTATAGTCCCAGCAGACCGTAATGTGTCACTCCAGGTTCCTGTCGTAACTTACTCAGTCGGTAAAGTGATACGATGACCTCCGTTAGGATTCAGTCTAAGCAACGTACACAGGGGGGAATTAATCCTGCATTAACCGCTCGGCCCAGTAGAAGTCTCAGTGGAACGGGACCCAGCCCCATCGAGTCAAGCTCTCTTGCTGCCACGGTTAAGTCAGGCTAATCGCGTGCGAATGTCCCGGCTACTTAGCCGGAACTCCCATGCATCAACTCGTCCTCAGGGCCTGGTCACTCTCTGGATAAACTCCAAAGTTTTCTAACACACGTGGAAATCTGACACCGACATCTGTCTGATATGCAATCATACTAGAGCTAGCGCATGACCCTTTGAATCCATTAAGAGGAGGGTTCAGTAGTGTGCCAAAACGAATCAGAGGGTCGGACCGAGTTTAGTGTGAGTATAATCTAAAGTTACGCTGTGGCTTGGTATGATGATGATTTACCAACACTCCGCAAAACGCTCCAATGCTCGTGTGCTATACTCGACCCCTAGGGCTTGAAGAGGTCACGGAGAGGGACGTGGTCGTTAGGTTTGGCCTCCAATTTTTGTGTTAAAAACTTTGTCCATCGGGTTACCTAGCTACCTGCGCACTCGTACAACGGAATATCTATTTGGCGGATCATAATAGACTAGGTGTCCCGTCCCTAACAACTATGGCGAACTAGACCTCCGATGAGGGGGCCGTAGAGATCATCGCGACAGAATCTCCTAGGTTGCCCCTCTACAGCGATAAAACAACACTACTTACCGCTTTCCCCGAAGATTCGCTTAGCTTATAGACCTCGCGGGCACCGGGAGTGGCCATCACTTAACACCGCTACAGGACCTCTTAGGAGAGTGTGGGTCAGATTCCGATTACTCAGTTCCAACTTGGTCAGATAATGACAGGTAAGTCAGGACTGATCGGATTCCGTGAACGGACGTGGTTTGCACGCCGGGAGAGTCGGATCCACCCAGTCTCCGAACCGATCATTTCCTCCTTGTAATCTCGTAGGGACGACACCCACGAATAAATGAAGGGTTTAATAGTCTTAGTGACTGCGTACGCTAGTACTGAACGATAAATCTTTATCGGATTTACCTAACAGTGACTATGGGTTCGAACTTAAAGCGTATTAAAGTCTTCAGTCTACACGTCCACCGCTTGATGACAAGGTCGATAGGTCGTTCTCGGGGCTTTAGTAGCACGCCGTTGTAGTCAGATCTGCCAGTTTCGATCCCTCACGCTAAGCCCCTCAACGGTCGGGACCGAGTGGGTTGTTGAAGTTCAAACCCGATAGGTCCACAGCCTTCAAAACTGAAGTTGTGAGTAACATGGGGTGGTTCGCATGACGGTAAGTCAGCACAGCAATGGAGGTCATCCCGAAACGACGGAAGCTCCCGGCCTTTACCGTGCAAATCTTTCGGGGTCGCGGGGTTAACAGTAGAGCCGCAGGGGAGCTTAGTCCAGAAATCCAAATCGGGGAGGCATTGGAACGCCGACGCTGTCCCTGCTACCGTGCCGATTCCGGCGCCCTGGCGGCTTATGGATGGGACGCCGCACTAAGATGTGTACAGTAGGGTTTGTCCTTAAAATTGCGTGTCCCGACTACAGGCCTA'/>

       <sequence taxon='t4' value='CTGTTTCGAAATATGAGTGGTAAAAAAGCGCTTTAGAGGCCATTAACAACGGCCATGGATGGGTGTCTGATGTGTATGACCTGCTCTGGGACTTGTTTCGTCGAACTGCATGCTTCTACTAAGAGCTCCGGGTGAAGGGCGGTGCCCAAGGCGTTGCTCGCACGGCCCACGCGCCTAGACTAAGACGATAGGGACTATCCTACAGCCCTGACGCTCGCGCCCATTTGGGCCGGTCGCACACCTGAAGGTAGGGTCAATAATGCCGCGCCCGACTCCTATATCGGGTGTAACTGTAGAACTTGATAGAAAGAGCCTTTCGTCTACGTAAGCAATTCGTTACAGATTATAGTCCCAGCAGACCGTAATGTGTCACTCCAGGTTCCTGTCGTAACTTACTCAGTCGGTAAAGTGATACGATGACCTCCGTTAGGATTCAGTCTAAGCAACGTACACAGGGGGGAATTAATCCTGCATTAACCGCTCGGCCCAGTAGAAGTCTCAGTGGAACGGGACCCAGCCCCGTTGAGTCAAGCTCTCTTGCTGCCACGGTTAAGTCAGGCTAATGGCGTGCGAATGTCCCGGCTCCTTAGCCGGAACTCCCATGCATCAACCCGTCCTCAGGGCCTGGTCTCTCTTTGGATAAACTCCAAAGTCTTCTAACACACGTAGAAATCTGACACCGACATCTGTCTGATATGGAATCATACTAGAGCTAGCGGATGACCCTTTGAATCCATTAAGCGGAGGGTTCAGTAGTGTGCCAAAACGAATCAGAGGGTCGCACCGAGTTTAGTGTGAGTATAATCTAAAGTTATGCTGTGGCTTGGTATGATGATGATTTACCAACACTCCGCAAAAGGCTCGAATGCTCGTGTGGTATACTCGACCCCTAGGGCTTGAAGAGGTCACGGAGAGGGACGTGGTCGTTAGGTTTGGCCACCAATTTTTGTGTTAAAAACTTTGTCCATAGGGTTACCTAGCTACCTGCGCACTCGTACAACGGAATATCTATTTGGCGGATCATAATAGACTAGGTGTCCCGTCCCTAACAACTATGGCGAACTAGACCTCCGGTGAGGGGGCCGTAGAGATCATCGCAACAGAATCTCCTAGGTTGGCCCTCTACAGCGATAAAACAAAACTACTTACCGCTTTCACCGAAGATTCGCTTAGCTTATAGACCTCGTGGGCACCGGGAGTGGCCAGCACTTAACTCCGCTAGAGGACCTCTTAGGAGAGTGTGGGTCAGATTCCGATTACTCAGTTCCAACTTGTTCAGATGATGACAGGTAAGTCAGGACTGATCGGATTCCGTGAACGGACGTGGTTTGCACGCCGGGAGAGTCGGATCCACCCAGTCTCCGAACCGATCATTTCCTCGTTGTAATCACGTAGGGACGACACCCACGAATAAATGAAGGGTTTAATAGTCTTAGTGACTGCGAACGCTAGTACTGCACGATAAATCTATATCGGATTTACCTAACAGTGACTACGGGTTCGAACTTAAAGCGTATTAAAGTCTTCAGTCTACACGTCCACCGCTTGATGACAAGGTCGATAGCTCGTTCTCGGGGCTTTAGTAGCACGCCGTTGTAGTCAGATCTGCCCGTTTCGATCCCTCACGCTAAGCCCCTCAACGGTCGGGACCGAGTGGGTTGTTGAATTTGAAACCCGATAGGTCCACCGCCTTCAAAACTGAAGCTGTCAGTAACATGGGGTGGTTCGCATGACGGTAAGTCAGCACAGCAATGGAGGTCATCCCGAAACGACGGAAGCTCCCGGTCTTTACCGTGCAAATCTTTCGGGGTAGCGGGGTTAACAGTAGAGCTGCAGGGGAGCTTAGTCCAGAAATCCAAAGCGGGGAGGCATTGGAACGCCGACGCTGTCCCTGCTACCGTGCCGATTCCGGCACCCTGGCGGCTTATGGATGGGACGCCGCACTAAGATGTGTACAGTGGGGTTTGTCCTTAAAATTGCGTGTCCCGACTACAGAGCTA'/>

   </input>
 
 
   <!-- INFERENCE  -->
 
   <typeTraitSet spec='TraitSet' id='typeTraitSet'
 	  traitname="discrete"
 	  value="
		 t1=0,
 		 t2=0,
 		 t3=1,
 		 t4=1">
     <taxa spec='TaxonSet' alignment='@simulated_alignment'/>
   </typeTraitSet>

   <traitSet spec='TraitSet' id='timeTraitSet'
 	    traitname="time"
 	    value="t1=0.0,
		   t2=0.0,
		   t3=1.5,
		   t4=1.5">
     <taxa spec='TaxonSet' alignment='@simulated_alignment'/>
   </traitSet>

   <!-- Substitution model -->
   <siteModel spec="SiteModel" id="siteModel">
     <mutationRate spec='RealParameter' id="mutationRate" value="1.0"/>
     <substModel spec="JukesCantor"/>
   </siteModel>
 
   <!-- Migration model -->
   <migrationModel spec='MigrationModel' id='migModel'>
     <rateMatrix spec='RealParameter' value="1.0 1.0" id="rateMatrix"/>
     <popSizes spec='RealParameter' value="1.0 1.0" dimension="2" id="popSizes"/>
   </migrationModel>
 
   <!-- Parameter priors -->
   <input spec='CompoundDistribution' id='parameterPriors'>
     <distribution spec='beast.math.distributions.Prior' x="@mutationRate">
       <distr spec='LogNormalDistributionModel' M="0.0" S="4.0"/>
     </distribution>
     <distribution spec='beast.math.distributions.Prior' x="@rateMatrix">
       <distr spec='LogNormalDistributionModel' M="0.0" S="4.0"/>
     </distribution>
     <distribution spec='beast.math.distributions.Prior' x="@popSizes">
       <distr spec="LogNormalDistributionModel"  M="-2.0" S="2.0"/>
     </distribution>
   </input>
 
   <!-- Probability of sequence data given tree -->
   <input spec='TreeLikelihood' id="treeLikelihood">
     <data idref="simulated_alignment"/>
     <tree idref="tree"/>
     <siteModel idref='siteModel'/>
   </input>
   
   <!-- Probability of tree given migration rates and population sizes -->
   <input spec='StructuredCoalescentLikelihood' id='treePrior'>
     <multiTypeTree idref="tree"/>
     <migrationModel idref="migModel"/>
   </input>
   
   <run spec="MCMC" id="mcmc" chainLength="20000000">
     
     <init spec='StructuredCoalescentMultiTypeTree' id='tree' nTypes="2">
         <migrationModel spec='MigrationModel'>
             <rateMatrix spec='RealParameter' value="1.0 1.0"/>
             <popSizes spec='RealParameter' value="1.0 1.0"/>
         </migrationModel>
         <typeTraitSet idref='typeTraitSet'/>
         <timeTraitSet idref='timeTraitSet'/>
     </init>
 
     <state>
       <stateNode idref="tree"/>
       <stateNode idref="rateMatrix"/>
       <stateNode idref="popSizes"/>
       <stateNode idref="mutationRate"/>
     </state>
     
     <distribution spec='CompoundDistribution' id='posterior'>
       <distribution idref="treeLikelihood"/>
       <distribution idref='treePrior'/>
       <distribution idref="parameterPriors"/>
     </distribution>

 
     <!-- parameter scaling operators -->

<!--
     <operator spec='ScaleOperator' id='RateScaler'
 	      parameter="@rateMatrix"
 	      scaleFactor="0.1" weight="1">
     </operator>
     
     <operator spec="ScaleOperator" id="PopSizeScaler"
 	      parameter="@popSizes" scaleFactor="0.1" weight="1"/>

     <operator spec="ScaleOperator" id="muRateScaler"
	       parameter="@mutationRate" scaleFactor="0.1" weight="1"/>
-->
     <!-- Multi-type tree operators -->

     <operator spec='TypedSubtreeExchange' id='STX'
 	      weight="1" multiTypeTree="@tree"
 	      migrationModel="@migModel"/>

     <operator spec="NodeRetype" id="NR"
 	      weight="1" multiTypeTree="@tree"
 	      migrationModel="@migModel"/>

     <!--
     <operator spec="NodeShiftRetype" id="NSR1"
               weight="1" multiTypeTree="@tree"
               migrationModel="@migModel" rootOnly="false"/>

     <operator spec="NodeShiftRetype" id="NSR2"
               weight="1" multiTypeTree="@tree"
               migrationModel="@migModel" noRoot="true"/>
          
     <operator spec="MultiTypeTreeScale" id="MTTS"
 	      weight="1" multiTypeTree="@tree"
 	      scaleFactor="1.1" useOldTreeScaler="false">
         <parameter idref="popSizes"/>         
         <parameterInverse idref="rateMatrix"/>
         <parameterInverse idref="mutationRate"/>
     </operator>
     
     <operator spec="TypedWilsonBalding" id="TWB"
 	      weight="1" multiTypeTree="@tree"
 	      migrationModel="@migModel" alpha="0.2"/>
     -->
           
     <logger logEvery="1000" fileName="4_time_samples_muinf.log">
       <model idref='posterior'/>
       <log idref="posterior"/>
       <log idref="popSizes"/>
       <log idref="rateMatrix"/>
       <log idref="mutationRate"/>
       <log spec='beast.evolution.tree.TreeHeightLogger' tree='@tree'/>
       <log spec='beast.evolution.tree.TreeLengthLogger' tree='@tree'/>
       <log spec='beast.evolution.tree.TypeChangeCountLogger'
            multiTypeTree="@tree" logEachDirection="true"/>
       <log spec='beast.evolution.tree.TypeChangeCountLogger'
            multiTypeTree="@tree" logEachDirection="false"/>
     </logger>
     <logger logEvery="10000" fileName="4_time_samples_muinf.trees" mode="tree">
       <log idref="tree"/>
     </logger>
     <!--
     <logger logEvery="10000">
       <model idref='posterior'/>
       <log idref="posterior"/>
       <log spec='beast.evolution.tree.TreeHeightLogger' tree='@tree'/>
       <log idref="popSizes"/>
       <log idref="rateMatrix"/>
       <log idref="mutationRate"/>
       <ESS spec='ESS' name='log' arg="@posterior"/>
     </logger>
     -->
   </run>
   
 </beast>
